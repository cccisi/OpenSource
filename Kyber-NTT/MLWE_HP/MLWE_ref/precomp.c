#include "inttypes.h"
#include "ntt.h"
#include "params.h"

const uint16_t omegas_inv_bitrev_montgomery[KYBER_N/2] = {990, 254, 862, 5047, 6586, 5538, 4400, 7103, 2025, 6804, 3858, 1595, 2299, 4345, 1319, 7197, 7678, 5213, 1906, 3639, 1749, 2497, 2547, 6100, 343, 538, 7390, 6396, 7418, 1267, 671, 4098, 5724, 491, 4146, 412, 4143, 5625, 2397, 5596, 6122, 2750, 2196, 1541, 2539, 2079, 2459, 274, 7524, 6539, 5015, 6097, 7040, 5220, 2716, 1752, 28, 2552, 133, 4441, 6719, 2298, 6952, 7075, 4672, 5559, 6830, 1442, 2979, 485, 4549, 4224, 6065, 1944, 5, 1553, 5046, 3436, 4766, 959, 3291, 3684, 6031, 2137, 1597, 2908, 1825, 6132, 98, 1251, 4306, 4022, 4314, 362, 1289, 5560, 3830, 6724, 6671, 1215, 2281, 4899, 5074, 5988, 5041, 1883, 2822, 7024, 2920, 594, 6189, 6662, 3247, 771, 5822, 1742, 4206, 3686, 776, 5987, 8, 4021, 38, 5658, 3017, 6143, 889, 4216};

const uint16_t psis_inv_montgomery[KYBER_N] = {
  1024, 4972, 5779, 6907, 4943, 4168,  315, 5580,   90,  497, 1123,  142, 4710, 5527, 2443, 4871,
   698, 2489, 2394, 4003,  684, 2241, 2390, 7224, 5072, 2064, 4741, 1687, 6841,  482, 7441, 1235,
  2126, 4742, 2802, 5744, 6287, 4933,  699, 3604, 1297, 2127, 5857, 1705, 3868, 3779, 4397, 2177,
   159,  622, 2240, 1275,  640, 6948, 4572, 5277,  209, 2605, 1157, 7328, 5817, 3191, 1662, 2009,
  4864,  574, 2487,  164, 6197, 4436, 7257, 3462, 4268, 4281, 3414, 4515, 3170, 1290, 2003, 5855,
  7156, 6062, 7531, 1732, 3249, 4884, 7512, 3590, 1049, 2123, 1397, 6093, 3691, 6130, 6541, 3946,
  6258, 3322, 1788, 4241, 4900, 2309, 1400, 1757,  400,  502, 6698, 2338, 3011,  668, 7444, 4580,
  6516, 6795, 2959, 4136, 3040, 2279, 6355, 3943, 2913, 6613, 7416, 4084, 6508, 5556, 4054, 3782,
    61, 6567, 2212,  779,  632, 5709, 5667, 4923, 4911, 6893, 4695, 4164, 3536, 2287, 7594, 2848,
  3267, 1911, 3128,  546, 1991,  156, 4958, 5531, 6903,  483,  875,  138,  250, 2234, 2266, 7222,
  2842, 4258,  812, 6703,  232, 5207, 6650, 2585, 1900, 6225, 4932, 7265, 4701, 3173, 4635, 6393,
   227, 7313, 4454, 4284, 6759, 1224, 5223, 1447,  395, 2608, 4502, 4037,  189, 3348,   54, 6443,
  2210, 6230, 2826, 1780, 3002, 5995, 1955, 6102, 6045, 3938, 5019, 4417, 1434, 1262, 1507, 5847,
  5917, 7157, 7177, 6434, 7537,  741, 4348, 1309,  145,  374, 2236, 4496, 5028, 6771, 6923, 7421,
  1978, 1023, 3857, 6876, 1102, 7451, 4704, 6518, 1344,  765,  384, 5705, 1207, 1630, 4734, 1563,
  6839, 5933, 1954, 4987, 7142, 5814, 7527, 4953, 7637, 4707, 2182, 5734, 2818,  541, 4097, 5641};

const uint16_t zetas[KYBER_N] = {990, 7427, 2634, 6819, 578, 3281, 2143, 1095, 484, 6362, 3336, 5382, 6086, 3823, 877, 5656, 3583, 7010, 6414, 263, 1285, 291, 7143, 7338, 1581, 5134,
  5184, 5932, 4042, 5775, 2468, 3, 606, 729, 5383, 962, 3240, 7548, 5129, 7653, 5929, 4965, 2461, 641, 1584, 2666, 1142, 157, 7407, 5222, 5602, 5142, 6140, 5485, 4931, 1559, 2085, 5284,
  2056, 3538, 7269, 3535, 7190, 1957, 3465, 6792, 1538, 4664, 2023, 7643, 3660, 7673, 1694, 6905, 3995, 3475, 5939, 1859, 6910, 4434, 1019, 1492, 7087, 4761, 657, 4859, 5798, 2640, 1693,
  2607, 2782, 5400, 6466, 1010, 957, 3851, 2121, 6392, 7319, 3367, 3659, 3375, 6430, 7583, 1549, 5856, 4773, 6084, 5544, 1650, 3997, 4390, 6722, 2915, 4245, 2635, 6128, 7676, 5737, 1616,
  3457, 3132, 7196, 4702, 6239, 851, 2122, 3009, 7613, 7295, 2007, 323, 5112, 3716, 2289, 6442, 6965, 2713, 7126, 3401, 963, 6596, 607, 5027, 7078, 4484, 5937, 944, 2860, 2680, 5049, 1777,
  5850, 3387, 6487, 6777, 4812, 4724, 7077, 186, 6848, 6793, 3463, 5877, 1174, 7116, 3077, 5945, 6591, 590, 6643, 1337, 6036, 3991, 1675, 2053, 6055, 1162, 1679, 3883, 4311, 2106, 6163,
  4486, 6374, 5006, 4576, 4288, 5180, 4102, 282, 6119, 7443, 6330, 3184, 4971, 2530, 5325, 4171, 7185, 5175, 5655, 1898, 382, 7211, 43, 5965, 6073, 1730, 332, 1577, 3304, 2329, 1699, 6150,
  2379, 5113, 333, 3502, 4517, 1480, 1172, 5567, 651, 925, 4573, 599, 1367, 4109, 1863, 6929, 1605, 3866, 2065, 4048, 839, 5764, 2447, 2022, 3345, 1990, 4067, 2036, 2069, 3567, 7371, 2368,
  339, 6947, 2159, 654, 7327, 2768, 6676, 987, 2214};

 const uint16_t bvpsi_7681_256[KYBER_N] = {
 1, 4298, 1213, 5756, 7154, 849, 5953, 583, 1366, 2784, 5543, 5033, 2132, 7584, 5300, 5235, 7351, 2645, 6803, 5408, 4928, 4027, 1846, 7316, 2399, 3000, 6569, 5887, 3092,
 1286, 2268, 675, 5773, 2724, 5258, 1382, 6986, 799, 1875, 1381, 5212, 3380, 693, 5967, 3074, 732, 3477, 4601, 7479, 7438, 766, 4800, 6601, 5165, 3411, 5130, 584, 6026,
 1740, 4907, 7153, 4232, 4740, 2508, 3844, 7362, 405, 4784, 1996, 6812, 1633, 5881, 4781, 2063, 198, 6094, 7462, 3501, 3188, 6801, 6526, 5417, 4608, 3566, 1886, 2573, 6461,
 2563, 4556, 2819, 3789, 1402, 3141, 4501, 257, 6203, 1003, 1853, 3041, 4837, 1408, 6637, 2722, 993, 2880, 4149, 6266, 1682, 3078, 2562, 648, 4582, 6974, 2990, 2681, 1438,
 3901, 6556, 417, 2593, 2044, 5729, 6090, 5653, 5833, 7131, 1228, 1097, 62, 5322, 6077, 3546, 5731, 6552, 398, 5422, 201, 3626, 5702, 4806, 1607, 1667, 5998, 1968, 2583,
 2689, 7012, 5013, 5977, 3882, 6918, 413, 2799, 1656, 185, 3987, 7360, 2922, 2358, 3445, 4600, 7587, 3394, 1193, 2996, 3452, 1035, 1131, 542, 2173, 4561, 1266, 6244, 6979,
 506, 1065, 2838, 296, 1406, 5722, 2169, 5309, 4095, 3139, 5484, 4924, 346, 4675, 5669, 1230, 2002, 1876, 217, 3265, 2067, 4730, 856, 7570, 1393, 3615, 4544, 5010, 4595,
 1459, 1784, 1994, 5631, 6888, 5200, 5571, 1499, 6024, 1717, 5906, 1170, 5286, 5956, 5796, 4488, 2433, 2717, 2546, 572, 536, 738, 7352, 4198, 335, 2805, 4401, 7463, 118,
 1897, 3765, 4442, 4431, 6492, 5224, 1771, 7568, 2252, 1036, 4921, 4665, 3751, 7060, 2811, 7146, 3832, 1872, 1211, 4841, 639, 4305, 7007, 6566};

 const uint16_t invpsi_7681_256[KYBER_N] = {1, 1115, 6584, 5805, 5173, 7145, 1478, 4236, 7006, 113, 3099, 6616, 3080, 793, 880, 5713, 2446, 535, 5088, 4542, 2551, 2395,
 5118, 7268, 365, 7563, 6688, 6550, 6300, 4066, 1800, 2259, 7098, 2840, 2028, 3006, 2774, 5248, 6279, 3694, 1794, 3250, 5999, 6415, 1714, 6222, 1587, 2875, 2648, 3016, 6243,
 1959, 2881, 1657, 4115, 2668, 2273, 7346, 2844, 6488, 6299, 2951, 2897, 4135, 1925, 3376, 550, 6451, 3449, 5135, 3180, 4759, 6395, 2457, 5119, 702, 6949, 5687, 4180, 6014,
 97, 621, 1125, 2372, 2516, 1775, 5108, 3799, 3654, 3280, 1044, 4229, 6882, 111, 869, 1129, 6832, 5809, 1952, 2757, 1655, 1885, 4862, 6025, 4681, 3916, 3532, 5508, 4301, 2671,
 5618, 4055, 4897, 6645, 4691, 7385, 243, 2110, 2264, 4992, 5036, 329, 5828, 94, 4957, 4416, 319, 2359, 3383, 674, 6453, 5679, 2941, 7109, 7424, 5323, 5413, 5910, 7033, 7175,
 4204, 2050, 4493, 1683, 2381, 4870, 7264, 3586, 4270, 6511, 1220, 763, 5835, 218, 4959, 6646, 5806, 6288, 6048, 7283, 1728, 6470, 1591, 7335, 5941, 3193, 3892, 7496, 1112, 3239,
 1415, 3120, 6988, 3086, 7483, 1979, 2138, 2760, 5000, 6275, 6915, 6182, 3073, 669, 878, 3483, 4640, 4287, 2423, 5614, 7276, 1604, 6468, 7042, 1848, 2012, 528, 4964, 4540, 321,
 4589, 1189, 4603, 1437, 4607, 5897, 219, 6074, 5549, 3930, 3780, 5512, 1080, 5964, 5795, 1704, 2753, 4876, 6273, 4685, 695, 6825, 5685, 1950, 527, 3849, 5637, 2197, 7097, 1725,
 3125, 4882, 5282, 5784, 4801, 7139, 2469, 3137, 2900, 7480, 6315, 5429, 707, 4843, 202, 2481, 1155, 5098, 330, 6943, 6678, 3081, 1908, 7464, 3837, 7619};


/* Pari/GP
brv=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,
8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,
4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,
12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,
2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,
10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255];

q = 7681;
n = 256;
mont = Mod(2^18,q);

g=0; for(i=2,q-1,if(znorder(Mod(i,q)) == 2*n, g=Mod(i,q); break))

zetas = lift(vector(n, i, g^(brv[i])*mont))
omegas_inv_bitrev_montgomery = lift(vector(n/2, i, (g^2)^(-brv[2*(i-1)+1])*mont))
psis_inv_montgomery = lift(vector(n, i, g^(-(i-1))/n*mont))
*/
