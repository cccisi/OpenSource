# MLWE

MLWE NTT Core on A7 FPGA

## 参考代码
- MLWE_ref 文件夹下是本文NTT的参考软件实现


## 版本说明
- MLWE-HP和MLWE-HP1024是Integration期刊的kyber-NTT代码，正CT,正反变换都用GS，reference文件是硬件实现用的

NTT第一对输出0，128 分别是28c1460,134e9a7
最后一轮最后的输出948，1290948
6030 189 1378 3322 3083 6858 6318 4728 6 6773 833 2369 5095 6483 5364 2552 2795 2828 2944 4633 5841 809 2271 6088 5703 4158 704 1047 3706 1228 6842 6427 7307 6607 206 3202 6371 7251 2800 5957 4053 5879 3307 331 2445 6203 6217 216 3525 5469 6345 5034 6719 4506 427 104 2457 7552 1416 1575 7239 6403 2897 1462 5592 7601 5939 671 1849 5502 2891 4659 7566 3273 1270 1759 5054 2491 895 3148 226 4957 3971 5637 914 4201 4369 3273 6101 438 2637 4748 4523 228 5936 2461 2985 5673 7202 7488 7279 838 1539 4433 6177 4240 4733 370 749 5273 1049 5251 5742 3327 5262 5771 4933 1574 3585 5620 1175 2194 2785 4552 1730 6680 5834 6956 3628 2150 5062 3246 2392 3039 2673 486 5486 2943 5634 1361 4136 7574 2457 3005 4553 1813 5079 4732 6301 3101 5210 6619 6309 2814 4625 3554 5244 2473 2988 7660 1017 6599 722 6476 1756 4438 3529 5137 2423 1284 6250 3834 2168 3858 6562 4638 1736 3984 3498 732 105 3620 2109 5719 7377 3154 3648 5907 5165 1487 54 6856 363 2507 5287 6880 4757 5380 390 7226 6289 2339 3905 5653 4116 7591 7570 4971 6694 6963 6064 6477 6642 2635 7149 557 18 83 7454 4997 2063 2416 302 1807 1889 5306 1106 250 1627 7116 5935 4153 1220 5679 5123 616 6745 4622 5466 434 4344 3750 829 4137 1600 2657 2255 511 2861 3047 4796 1894 6664 739 3789 2376 7454

mulacc
注意：A 必须是倒位序输入
S口第一个10111100011101011110001110即2f1d78e是6030
3*178e = 46aa
MACC
5456 378 3343 6644 7199 6279 2229 6534 5814 2233 672 3694 3761 6983 2250 7631 3499 1606 2950 6340 1902 3236 4006 2618 3494 1905 4045 6282 7143 4011 344 6153 5437 5533 1648 6404 5656 2758 3519 7092 2366 4550 1506 3833 6825 1665 6139 1296 6419 2090 6551 1867 6488 2662 3875 832 7061 6907 6303 1769 5913 3269 7427 3374 2828 7521 1426 1342 2008 4473 3883 4109 3780 4276 1670 3615 7275 2926 1226 3526 904 6699 4934 6691 7521 1442 6496 3141 5882 2628 1437 5445 2730 3672 5119 3599 2548 3665 3849 7295 2193 6486 6156 619 2014 2397 720 7603 7557 6496 1703 782 7606 4600 1714 82 1271 6296 7440 6555 7050 5483 2942 4269 6920 2879 2808 4127 6406 4300 2091 6492 5867 5373 3011 5058 682 2296 5836 6107 1838 6362 1675 2668 2850 3197 7067 7132 5267 4723 1878 6866 7130 1522 6706 5962 5614 7083 377 2694 6102 5517 5776 5271 4063 5367 6435 5101 5182 23 3622 1932 1528 5133 175 4785 6944 861 176 5856 5360 6799 2320 7347 5857 3562 6995 4718 5298 97 7549 7080 2178 5014 3891 6079 933 504 1560 4937 3008 6353 4893 3666 180 5423 5392 6783 3733 3373 4991 5730 7678 2859 6127 4456 108 498 3660 6939 571 6165 3529 7396 3653 2931 1167 500 1958 3088 697 4248 6987 3350 2261 659 2288 4501 4561 2604 2014 7138 5887 2372 6695 2947 3555 4088 1804 2920 193 3683 3613 3008 6100 0

INVNTT变换后
第一个 2d956ca
6120 6387 4979 7134 4475 4656 4465 3171 2298 6061 2097 518 3842 186 7254 1635 4463 6132 6483 5741 2434 7613 2541 3738 299 5813 1189 1723 6686 7059 1350 2200 3951 4809 1464 3593 1095 5398 2399 2814 7612 4230 2770 6497 5212 3623 582 4230 3242 5508 3140 1629 1384 6084 3982 5308 282 2986 6158 3572 5798 1362 3360 6827 2694 2285 141 2789 5964 1263 6339 6194 4672 531 4695 4811 5864 3684 5517 6887 3164 4599 4723 2218 1128 7423 280 309 6588 6451 7126 7482 956 61 3789 1639 4701 6734 3601 7565 6995 2233 2865 6003 6382 1877 2943 5848 5929 6212 422 249 964 3853 3196 4865 3541 6405 4714 4944 2445 822 3 1374 3585 3271 3963 1216 3361 6471 3551 6045 876 694 3050 7365 5002 4826 5882 698 6689 462 6369 6348 31 3441 5262 6001 3395 4780 4001 7501 5230 7581 5721 7449 6149 6257 6264 4772 2464 5763 40 5838 6412 1478 3789 6416 2757 5178 6151 1183 861 1319 6847 4850 6364 1171 6271 1556 4271 7563 1901 2487 2919 6154 5871 4570 5773 3567 4545 6699 3226 3193 3232 93 7595 6157 1853 3625 5508 6541 7399 3559 966 3712 3933 6858 3610 4311 1015 3381 4753 4094 1402 1769 4849 4276 6106 859 7116 3505 2296 4458 4650 3095 332 1728 332 1868 4696 289 6148 3710 1387 7371 5807 2926 6725 5305 4366 6066 1227 7659 250 602 1195 2699 3140 5682 550 3384 6158 2959 1692 5894

- MULADD
747 416 4254 1049 4013 6268 4310 4729 194 2517 6224 7511 7645 2108 5138 4720 4370 387 5224 4437 3796 2042 586 3079 6395 2276 2743 2080 6809 3305 5595 3134 4369 1670 2170 7426 5560 7051 4842 77 2075 3680 1396 4804 4950 6532 5592 3680 2595 3745 5661 4901 4572 1826 3442 2065 6905 2595 7293 377 2725 5233 6743 2582 3674 580 3455 822 5429 524 1857 6211 5784 7116 5094 1617 752 4702 3481 780 4935 291 4257 2593 4571 61 6968 6096 2069 6179 1296 5973 2046 5858 1554 4602 4912 5368 7189 3481 5223 2148 6224 4260 570 5141 3887 1231 6483 5672 2711 214 1806 7309 3981 7674 1310 7558 4525 5304 3463 6067 7599 4869 7667 1730 4015 1930 6707 5577 1008 2995 4449 2232 674 1805 3565 1162 208 2111 6726 1509 964 1588 6753 4307 3449 4318 5690 2541 2872 5404 4404 3003 5041 6963 7557 4322 4114 2784 2893 3774 6485 1524 7351 1755 1547 7232 1786 5964 7500 2923 4903 6523 1986 442 1107 3278 3903 7091 2453 3542 4424 2204 4605 7408 541 1161 3475 531 1917 6422 3076 4064 2897 4892 2585 7324 5860 6471 3747 3479 784 772 1753 3862 4915 1650 6917 1250 282 6108 3355 78 4032 701 472 2300 1172 4957 1590 2391 258 4523 6442 7004 5406 1928 5407 5417 5061 6698 7590 3918 4481 1627 2462 4399 5646 2154 7280 2367 1603 664 187 4985 2561 3525 5656 6206 6551 6017 7287 3409 3016 7529


- testvector
——mlwe
NTT变换后
NTT变换后
5456 378 3343 6644 7199 6279 2229 6534 5814 2233 672 3694 3761 6983 2250 7631 3499 1606 2950 6340 1902 3236 4006 2618 3494 1905 4045 6282 7143 4011 344 6153 5437 5533 1648 6404 5656 2758 3519 7092 2366 4550 1506 3833 6825 1665 6139 1296 6419 2090 6551 1867 6488 2662 3875 832 7061 6907 6303 1769 5913 3269 7427 3374 2828 7521 1426 1342 2008 4473 3883 4109 3780 4276 1670 3615 7275 2926 1226 3526 904 6699 4934 6691 7521 1442 6496 3141 5882 2628 1437 5445 2730 3672 5119 3599 2548 3665 3849 7295 2193 6486 6156 619 2014 2397 720 7603 7557 6496 1703 782 7606 4600 1714 82 1271 6296 7440 6555 7050 5483 2942 4269 6920 2879 2808 4127 6406 4300 2091 6492 5867 5373 3011 5058 682 2296 5836 6107 1838 6362 1675 2668 2850 3197 7067 7132 5267 4723 1878 6866 7130 1522 6706 5962 5614 7083 377 2694 6102 5517 5776 5271 4063 5367 6435 5101 5182 23 3622 1932 1528 5133 175 4785 6944 861 176 5856 5360 6799 2320 7347 5857 3562 6995 4718 5298 97 7549 7080 2178 5014 3891 6079 933 504 1560 4937 3008 6353 4893 3666 180 5423 5392 6783 3733 3373 4991 5730 7678 2859 6127 4456 108 498 3660 6939 571 6165 3529 7396 3653 2931 1167 500 1958 3088 697 4248 6987 3350 2261 659 2288 4501 4561 2604 2014 7138 5887 2372 6695 2947 3555 4088 1804 2920 193 3683 3613 3008 6100 0
INVNTT变换后
747 3899 6120 4122 647 5170 3460 3692 757 6609 7326 2691 260 3230 7087 5253 5418 624 1934 1468 6245 4968 7668 5650 1120 6408 5455 6750 1767 6410 6756 4622 3595 3546 6075 3575 4192 677 6820 23 2775 4859 7643 2122 2292 3951 3185 4273 51 6584 6904 142 6596 3220 639 3977 1082 557 6819 6845 348 4610 5000 3658 6153 7374 161 4689 5015 298 1574 320 117 5501 6526 4599 4012 3223 5951 3768 5427 4682 297 7198 639 7576 7333 4983 5835 1394 5685 2692 7425 425 1385 3893 5199 1084 6770 132 3276 6733 3534 2554 7439 4034 158 5938 4690 6341 7603 6989 6477 3352 5495 588 5135 4466 7374 669 7581 1485 5208 157 148 3565 3837 2380 7392 6354 4650 2756 6437 6895 6464 5356 5798 3468 7134 2512 6176 4981 172 5529 7104 7413 3919 744 3677 1925 6352 2894 438 2550 5902 5105 361 315 1993 7254 5255 2016 3820 4908 2069 5649 7106 2580 3366 457 3789 6081 4645 2707 4790 5597 7525 902 6812 6231 7362 5131 7148 2639 3461 7585 6580 7053 7168 7315 713 4024 1925 1365 5462 6779 21 3791 249 7298 4148 553 5067 2207 3363 918 4356 300 1721 6715 5137 2799 3328 1318 795 4864 1093 2160 4436 284 1242 417 2860 4869 5106 6454 1189 1644 1430 6881 265 5012 297 5845 1497 1531 6282 4006 5089 1835 408 751 3011 6363 1778 6722 5170 4727 4424 1497 1591 307 935 3937 2858 7148

747 416 4254 1049 4013 6268 4310 4729 194 2517 6224 7511 7645 2108 5138 4720 4370 387 5224 4437 3796 2042 586 3079 6395 2276 2743 2080 6809 3305 5595 3134 4369 1670 2170 7426 5560 7051 4842 77 2075 3680 1396 4804 4950 6532 5592 3680 2595 3745 5661 4901 4572 1826 3442 2065 6905 2595 7293 377 2725 5233 6743 2582 3674 580 3455 822 5429 524 1857 6211 5784 7116 5094 1617 752 4702 3481 780 4935 291 4257 2593 4571 61 6968 6096 2069 6179 1296 5973 2046 5858 1554 4602 4912 5368 7189 3481 5223 2148 6224 4260 570 5141 3887 1231 6483 5672 2711 214 1806 7309 3981 7674 1310 7558 4525 5304 3463 6067 7599 4869 7667 1730 4015 1930 6707 5577 1008 2995 4449 2232 674 1805 3565 1162 208 2111 6726 1509 964 1588 6753 4307 3449 4318 5690 2541 2872 5404 4404 3003 5041 6963 7557 4322 4114 2784 2893 3774 6485 1524 7351 1755 1547 7232 1786 5964 7500 2923 4903 6523 1986 442 1107 3278 3903 7091 2453 3542 4424 2204 4605 7408 541 1161 3475 531 1917 6422 3076 4064 2897 4892 2585 7324 5860 6471 3747 3479 784 772 1753 3862 4915 1650 6917 1250 282 6108 3355 78 4032 701 472 2300 1172 4957 1590 2391 258 4523 6442 7004 5406 1928 5407 5417 5061 6698 7590 3918 4481 1627 2462 4399 5646 2154 7280 2367 1603 664 187 4985 2561 3525 5656 6206 6551 6017 7287 3409 3016 7529

—— 官方
after muladd
5456 378 3343 6644 7199 6279 2229 6534 5814 2233 672 3694 3761 6983 2250 7631 3499 1606 2950 6340 1902 3236 4006 2618 3494 1905 4045 6282 7143 4011 8025 6153 5437 5533 1648 6404 5656 2758 3519 7092 2366 4550 1506 3833 6825 1665 6139 1296 6419 2090 6551 1867 6488 2662 3875 832 7061 6907 6303 1769 5913 3269 7427 3374 2828 7521 1426 1342 2008 4473 3883 4109 3780 4276 1670 3615 7275 2926 1226 3526 904 6699 4934 6691 7521 1442 6496 3141 5882 2628 1437 5445 2730 3672 5119 3599 2548 3665 3849 7295 2193 6486 6156 619 2014 2397 720 7603 7557 6496 1703 782 7606 4600 1714 7763 1271 6296 7440 6555 7050 5483 2942 4269 6920 2879 2808 4127 6406 4300 2091 6492 5867 5373 3011 5058 682 2296 5836 6107 1838 6362 1675 2668 2850 3197 7067 7132 5267 4723 1878 6866 7130 1522 6706 5962 5614 7083 8058 2694 6102 5517 5776 5271 4063 5367 6435 5101 5182 7704 3622 1932 1528 5133 7856 4785 6944 861 7857 5856 5360 6799 2320 7347 5857 3562 6995 4718 5298 7778 7549 7080 2178 5014 3891 6079 933 8185 1560 4937 3008 6353 4893 3666 7861 5423 5392 6783 3733 3373 4991 5730 7678 2859 6127 4456 7789 498 3660 6939 571 6165 3529 7396 3653 2931 1167 500 1958 3088 697 4248 6987 3350 2261 659 2288 4501 4561 2604 2014 7138 5887 2372 6695 2947 3555 4088 1804 2920 7874 3683 3613 3008 6100 0
after INTT
747 416 4254 1049 4013 6268 4310 4729 194 2517 6224 7511 7645 2108 5138 4720 4370 387 5224 4437 3796 2042 586 3079 6395 2276 2743 2080 6809 3305 5595 3134 4369 1670 2170 7426 5560 7051 4842 77 2075 3680 1396 4804 4950 6532 5592 3680 2595 3745 5661 4901 4572 1826 3442 2065 6905 2595 7293 377 2725 5233 6743 2582 3674 580 3455 822 5429 524 1857 6211 5784 7116 5094 1617 752 4702 3481 780 4935 291 4257 2593 4571 7742 6968 6096 2069 6179 1296 5973 2046 5858 1554 4602 4912 5368 7189 3481 5223 2148 6224 4260 570 5141 3887 1231 6483 5672 2711 214 1806 7309 3981 7674 1310 7558 4525 5304 3463 6067 7599 4869 7667 1730 4015 1930 6707 5577 1008 2995 4449 2232 674 1805 3565 1162 208 2111 6726 1509 964 1588 6753 4307 3449 4318 5690 2541 2872 5404 4404 3003 5041 6963 7557 4322 4114 2784 2893 3774 6485 1524 7351 1755 1547 7232 1786 5964 7500 2923 4903 6523 1986 442 1107 3278 3903 7091 2453 3542 4424 2204 4605 7408 541 1161 3475 531 1917 6422 3076 4064 2897 4892 2585 7324 5860 6471 3747 3479 784 772 1753 3862 4915 1650 6917 1250 282 6108 3355 78 4032 701 472 2300 1172 4957 1590 2391 258 4523 6442 7004 5406 1928 5407 5417 5061 6698 7590 3918 4481 1627 2462 4399 5646 2154 7280 2367 1603 664 187 4985 2561 3525 5656 6206 6551 6017 7287 3409 3016 7529
